<!--
 Document File Format:
	- GFM (GitHub Flavored Markdown)
References:
	- [Mastering Markdown](https://guides.github.com/features/mastering-markdown/)
	- [Markdown Editor](https://jbt.github.io/markdown-editor/)
	- [A template to make good README.md](https://gist.github.com/PurpleBooth/109311bb0361f32d87a2)
-->

[![IDE](https://img.shields.io/badge/Eclipse-CDT%2FAutotools-blue.svg?logo=eclipse)](https://wiki.eclipse.org/Linux_Tools_Project/Autotools/User_Guide)
[![Latest release](https://img.shields.io/github/release/kimkim19642004/po2bats-autotools.svg)](https://github.com/kimkim19642004/po2bats-autotools/releases/latest)
[![License](http://img.shields.io/badge/license-MIT-blue.svg?style=flat)](https://choosealicense.com/licenses/mit/)
[![Build Status](https://travis-ci.com/kimkim19642004/po2bats-autotools.svg?branch=master)](https://travis-ci.com/kimkim19642004/po2bats-autotools)
[![Coverage Status](https://coveralls.io/repos/github/kimkim19642004/po2bats-autotools/badge.svg?branch=master)](https://coveralls.io/github/kimkim19642004/po2bats-autotools?branch=master)
[![codecov](https://codecov.io/gh/kimkim19642004/po2bats-autotools/branch/master/graph/badge.svg)](https://codecov.io/gh/kimkim19642004/po2bats-autotools)
[![Codacy Badge](https://api.codacy.com/project/badge/Grade/07329e94d8fc4d1caeac4e3b53c556ab)](https://www.codacy.com/app/kimkim19642004/po2bats-autotools?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=kimkim19642004/po2bats-autotools&amp;utm_campaign=Badge_Grade)

Note:
- [ShellCheck](https://www.shellcheck.net/) support of [Code Climate](https://codeclimate.com/) is insufficient.
- [kcov](https://github.com/SimonKagstrom/kcov) support of [Codacy](https://www.codacy.com/) is insufficient.

# po2bats

This is a shell script to generate BATS file from PO file.
Running the bats script allows you to test the integrity of MO files installed on your system and PO files that is the sources.

Note:
- See [The Format of PO Files](https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html).
- See [The Format of MO Files](https://www.gnu.org/software/gettext/manual/html_node/MO-Files.html).
- See [Bats-core: Bash Automated Testing System (2018)](https://github.com/bats-core/bats-core).

Some of usages of this command are shown below.

How to display help:
```
$ po2bats.sh --help
Usage: po2bats.sh [OPTION] PO BATS TEXTDOMAIN
Generate BATS file from PO file

OPTION:
      --msgdir=TEXTDOMAINDIR  Specify message catalog search path
      --msginfo               Display message catalog information and exit
      --help                  Display this help and exit
      --version               Display version information and exit

PO: Specify the name of an existing PO file
BATS: Specify the name of a new BATS file
TEXTDOMAIN,TEXTDOMAINDIR:
  See gettext command help for more information: gettext --help

URL: https://github.com/kimkim19642004/po2bats-autotools
Report bugs to: https://github.com/kimkim19642004/po2bats-autotools/issues
```

How to generate and execute BATS file (Example in Japanese locale):
```
$ echo $LANG
ja_JP.UTF-8
$ po2bats-autotools]$ po2bats.sh --msgdir=/usr/local/share/locale po/ja.po ja.bats po2bats
$ ./ja.bats
 ✓ ls /usr/local/share/locale/ja/LC_MESSAGES/po2bats.mo
 ✓ (null)
 ✓ Usage
 ✓ OPTION
 ✓ Generate BATS file from PO file
 ✓ Specify message catalog search path
 ✓ Display message catalog information and exit
 ✓ Display this help and exit
 ✓ Display version information and exit
 ✓ Specify the name of an existing PO file
 ✓ Specify the name of a new BATS file
 ✓ See gettext command help for more information
 ✓ Report bugs to
 ✓ This GNU command is not installed, or invalid path/link settings.
 ✓ See
 ✓ missing file operand
 ✓ Try the following command
 ✓ PO error
 ✓ BATS error
 ✓ TEXTDOMAIN error
 ✓ TEXTDOMAINDIR error
 ✓ This file was automatically generated by po2bats.sh. Do not edit!
 ✓ BATS tempfile error
 ✓ line
 ✓ Test counts
 ✓ Message not found
 ✓ CHECKSUM (message digest) tempfile error
 ✓ CHECKSUM (message digest) for all translated messages
 ✓ cannot move tempfile to target BATS file
 ✓ Target BATS file not found

30 tests, 0 failures
```
Note:
- 'ja.po' is an existing Japanese PO file.
- Place Japanese MO file 'test.mo' in the directory '/usr/local/share/locale/ja/LC_MESSAGES'.
- You can display the help of BATS command by executing command './ja.bats -h'.

## Getting Started

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes. See [Deployment](#id_deployment) for notes on how to deploy the project on a live system.

### Prerequisites

Install necessary packages for installing this software.

When the latest version of [Fedora](https://getfedora.org/) is clean installed:
```
$ sudo dnf install dnf-plugins-extras-tracer
$ sudo dnf upgrade
$ sudo dnf groupinstall "C Development Tools and Libraries"
$ sudo dnf groupinstall "Development Tools"
$ sudo dnf install gettext-devel autoconf-archive
$ sudo dnf install bats moreutils kcov lcov ShellCheck

(Let's also install the language pack! Example in Japanese locale:)
$ sudo dnf install man-pages-ja glibc-langpack-ja
(Don't forget to check the current locale information with the command 'locale'!)
```
Follow instructions of the DNF command, restart the specified applications, or reboot your system, or login to your system again.

Note:
- If Plugin for DNF command [dnf-plugins-extras-tracer](http://tracer.readthedocs.io/en/latest/user-guide/) is installed on your system, the DNF command will display information about running applications that need to be restarted. This plugin is useful, but it may take time to execute. To disable this plugin, specify '--disableplugin=tracer' as the command option.

### Installing

**Normal installation procedure** for this software is as follows:
```
$ cd $HOME
$ git clone https://github.com/kimkim19642004/po2bats-autotools.git
$ cd po2bats-autotools

(The following is required only after the initial 'git clone'.)
(Match the timestamps of the following files with the rules described in 'Makefile'.)
$ touch aclocal.m4
$ touch configure
$ touch Makefile.am
$ touch src/Makefile.am
$ touch Makefile.in
$ touch src/Makefile.in

$ ./configure && make
$ sudo make install
```

**Full installation procedure** for this software is as follows:
```
$ cd $HOME
$ git clone https://github.com/kimkim19642004/po2bats-autotools.git
$ cd po2bats-autotools

$ gettextize -f
$ autoreconf -f -i

$ ./configure && make
$ make check
$ make distcheck
$ sudo make install
$ make installcheck
```

Note:
- You can generate source files with 100% code coverage by executing the command **'./configure --enable-code-coverage --enable-testcode'**.
- Open the file '$HOME/po2bats-autotools/tests/coverage/index.html' in your web browser and see the code coverage.
- See **'NEWS'** for installation on other operating systems.
- Please read **'INSTALL'** carefully.

## Support Eclipse

See [EGit](https://www.eclipse.org/egit/) for how to import this project.

<div id="id_deployment"></div>

## Deployment

See [Creating RPM packages](https://docs.fedoraproject.org/en-US/quick-docs/creating-rpm-packages/index.html).

## Versioning and ChangeLog

We use [SemVer](http://semver.org/) for versioning. For the versions available, see [releases](https://github.com/kimkim19642004/po2bats-autotools/releases).

See [Keep a Changelog](https://keepachangelog.com/en/1.0.0/) for how to write **'CHANGELOG.md'**.

See [Change Logs](https://www.gnu.org/prep/standards/html_node/Change-Logs.html) for how to write GNU Style **'ChangeLog'**.

## Authors

See 'AUTHORS' for more information.

## License

See 'COPYING' for more information.

## NEWS

This is a document showing the latest operation confirmation situation etc.
See 'NEWS' for more information.
